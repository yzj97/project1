"use strict";var _createClass=function(){function o(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,e,i){return e&&o(t.prototype,e),i&&o(t,i),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}require(["../scripts/config.js"],function(){require(["jquery","swiper","_cookie","_jcookie","_pubilc"],function(s,t,e){var i=document.querySelector(".nav-item1"),o=document.querySelector(".list");i.onmouseenter=function(){o.style.display="block"},i.onmouseleave=function(){o.style.display="none"};for(var n=document.querySelectorAll(".list-item-goods"),l=document.querySelectorAll(".hide-list"),a=function(t){n[t].onmouseenter=function(){l[t].style.display="block"},n[t].onmouseleave=function(){l[t].style.display="none"}},c=0;c<n.length;c++)a(c);new(function(){function e(t){_classCallCheck(this,e),this.url=t.url,this.obox=t.obox,this.getCookie(),this.load()}return _createClass(e,[{key:"getCookie",value:function(){this.goods=JSON.parse(s.cookie("goods")),console.log(this.goods)}},{key:"load",value:function(){var e=this;s.ajax({url:this.url,success:function(t){e.res=t,e.display()}})}},{key:"display",value:function(){var e=this,n="";s.each(this.res,function(t,o){s.each(e.goods,function(t,e){if(o.id==e.id){var i=parseInt(e.num)*parseInt(o.price.slice(0,o.price.length-1));n+='\n      \t\t\t\t\t   <li class="main-goods-list-item">\n\t\t\t\t\t\t\t\t<div class="list-select">\n\t\t\t\t\t\t\t\t<i class="daguo"></i>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="list-img"><img src="'+o.src+'"></div>\n\t\t\t\t\t\t\t\t<div class="list-name">'+o.describe+'</div>\n\t\t\t\t\t\t\t\t<div class="list-price">'+o.price+'</div>\n\t\t\t\t\t\t\t\t<div class="list-num">\n\t\t\t\t\t\t\t\t\t<b class="reduce"></b><input class="num-value" type="text" value="'+e.num+'"><b class="add"></b>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="list-tatol">'+i+'元</div>\n\t\t\t\t\t\t\t\t<div class="list-action" index="'+e.id+'">\n\t\t\t\t\t\t\t\t\t<span class="delete">X</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n      \t\t\t\t\t'}})}),this.obox.html(n),this.calculate(),this.click(),this.del(),this.getgoodsnum(),this.sel(),this.selAll(),this.tixing()}},{key:"listtatol",value:function(t,e){s(".list-tatol").eq(t).html(e*parseInt(s(".list-price").eq(t).html().slice(0,s(".list-price").eq(t).html().length-1))+"元")}},{key:"calculate",value:function(){var i=0;s.each(s(".list-select .daguo"),function(t,e){i+=parseInt(s(e).parent().siblings(".list-tatol").html())}),s(".bottom-tatol span").html(i)}},{key:"click",value:function(){var o=this;s.each(s(".add"),function(t,e){s(e).on("click",function(){var e=parseInt(s(".num-value").eq(t).val());e++,s(".num-value").eq(t).val(e),o.listtatol(t,e),o.calculate(),o.id=s(".list-action").eq(t).attr("index"),o.setCookie(function(t){o.goods[t].num=e}),o.getgoodsnum()})}),s.each(s(".reduce"),function(t,e){s(e).on("click",function(){var e=parseInt(s(".num-value").eq(t).val());--e<=1&&(e=1),s(".num-value").eq(t).val(e),o.listtatol(t,e),o.calculate(),o.id=s(".list-action").eq(t).attr("index"),o.setCookie(function(t){o.goods[t].num=e}),o.getgoodsnum()})}),s.each(s(".num-value"),function(i,t){s(t).on("input",function(){var t=s(this).val();if(t){var e=parseInt(t);o.listtatol(i,e),o.calculate(),o.id=s("list-action").eq(i).attr("index"),o.setCookie(function(t){o.goods[t].num=e})}o.getgoodsnum()})})}},{key:"del",value:function(){var e=this;this.obox.on("click","span",function(){s(this).parent().parent().remove(),e.id=s(this).parent().attr("index"),e.setCookie(function(t){e.goods.splice(t,1)}),e.calculate(),e.getgoodsnum()})}},{key:"setCookie",value:function(t){for(var e=0;e<this.goods.length;e++)if(this.goods[e].id==this.id){t(e);break}s.cookie("goods",JSON.stringify(this.goods))}},{key:"getgoodsnum",value:function(){var i=0,o=0;s.each(s(".list-select .daguo"),function(t,e){i+=parseInt(s(e).parent().siblings(".list-num").children(".num-value").val())}),s.each(s(".num-value"),function(t,e){o+=parseInt(s(e).val())}),s(".bottom-left em").html(o),s(".bottom-left i").html(i)}},{key:"sel",value:function(){var i=this;s.each(s(".list-select i"),function(t,e){s(e).on("click",function(){s(this).hasClass("daguo")?s(this).removeClass("daguo"):s(this).addClass("daguo"),i.calculate(),i.getgoodsnum(),i.tixing(),s(".list-select").find(".daguo").length!=s(".main-goods-list-item").length&&s(".top-select i").removeClass("daguo")})})}},{key:"selAll",value:function(){var i=this;s(".top-select i").on("click",function(){s(this).hasClass("daguo")?(s(this).removeClass("daguo"),s.each(s(".list-select i"),function(t,e){s(e).removeClass("daguo"),i.calculate(),i.getgoodsnum()})):(s(this).addClass("daguo"),s.each(s(".list-select i"),function(t,e){s(e).addClass("daguo"),i.calculate(),i.getgoodsnum()})),i.tixing()})}},{key:"tixing",value:function(){0==s(".list-select").find(".daguo").length?(s(".jiesuan").css("display","block"),s(".bottom-pay").css({backgroundColor:"#E0E0E0",color:"#b0b0b0"}),s(".top-select i").removeClass("daguo")):(s(".jiesuan").css("display","none"),s(".bottom-pay").css({backgroundColor:"#FF7600",color:"#FFFFFF"}),s(".top-select i").addClass("daguo"))}}]),e}())({url:"https://localhost:8848/ajax/goodslist.json",obox:s(".main-goods-list")});var u=document.querySelector(".mengban");document.querySelector(".bottom-pay").onclick=function(){if(0!=s(".list-select").find(".daguo").length){var t=document.createElement("img"),e=document.createElement("div");t.src="../static/icon/zhifubao.jpg",t.className="zhifubao",e.innerHTML="X",e.className="guanbi";var i=document.createElement("div");i.className="zhibi",i.appendChild(t),i.appendChild(e),document.body.appendChild(i),u.style.display="block",e.onclick=function(){u.style.display="none",i.remove()}}}})});